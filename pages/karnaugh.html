---
title: Table de Karnaugh
---

<link rel="stylesheet" href="/css/karnaugh.css">
<script src="/js/karnaugh-tables.js"></script>

<style>
#karnaugh-table td:not(.empty) {
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
}
</style>

<section>
<h1>Table de Karnaugh</h1>

<p>
    Cliquez dans les cellules pour changer les valeurs.
    Vous pouvez laisser une cellule vide pour indiquer que la valeur n'a pas d'importance.
    Entrez ensuite une proposition dans le champ de texte ci-dessous et cliquez sur le bouton <i>Vérifier</i> pour voir si la proposition correspond à la table de Karnaugh.
</p>

<table id="karnaugh-table"></table>

<div class="expr-input">
    <input type="text" placeholder="" autocomplete="off" autocorrect="off" autocapitalize="off" id="expr-input" />
    <button id="verify-button">Vérifier</button>
</div>

<div id="output"></div>
</section>

<script type="text/javascript">

function toggleValue(cell) {
    const value = cell.textContent;
    if (value === '0') {
        cell.textContent = '1';
        cell.classList.remove('zero');
        cell.classList.add('one');
    } else if (value === '1') {
        cell.textContent = '';
        cell.classList.remove('one');
        cell.classList.remove('zero');
    } else {
        cell.textContent = '0';
        cell.classList.remove('one');
        cell.classList.add('zero');
    }
}

function reask(vs) {
    let text = prompt('Entrez les variables séparées par des virgules (ex: A, B, C)', vs ? vs.join(', ') : '');
    if (!text) {
        text = (vs ? vs.join(',') : '');
    }
    else {
        text = text.trim();
        text = text.split(',').map(v => v.trim()).join(',');
    }
    window.location.search = '?vs=' + text;
}

(function() {
    // Lookup variables in URL
    let variables = new URLSearchParams(window.location.search).get('vs');

    // If no variables are found, ask the user
    if (!variables) {
        reask();
    }

    variables = variables.split(',').map(v => v.trim());

    // Check that there are between 2 and 4 variables
    if (variables.length < 2 || variables.length > 4) {
        alert('Le nombre de variables doit être compris entre 2 et 4.');
        reask(variables);
    }

    // Check that all entries are valid variable names
    for (const name of variables) {
        let expr = null;
        try {
            expr = logicQuestions.parse(name);
        }
        catch (e) {
            // Ignore
        }
        if (expr !== null && expr.kind !== 'Variable') {
            alert('Noms de variables invalides.');
            reask(variables);
        }
    }

    // Check if there are no duplicates
    const unique = new Set(variables);
    if (unique.size !== variables.length) {
        alert('Les noms de variables doivent être uniques.');
        reask(variables);
    }

    const ktable = new KarnaughTable('karnaugh-table', variables);
    ktable.forEachCell(cell => {
        cell.addEventListener('click', () => {
            toggleValue(cell);
        });
    })

    const exprInput = document.getElementById('expr-input');
    const verifyButton = document.getElementById('verify-button');

    function handler() {
        const text = exprInput.value;
        if (text.trim() === '') {
            output.innerHTML = '';
            ktable.unselect();
            return;
        }
        let expr;
        try {
            expr = logicQuestions.parse(text);
        } catch (e) {
            output.innerHTML = '<p>Oups, la proposition est mal formée.</p>';
            ktable.unselect();
            return;
        }
        const usedVariables = logicQuestions.freeVariables(expr);
        const unknownVariables = [];
        console.log(variables, usedVariables);
        for (const usedVariable of usedVariables) {
            if (!variables.includes(usedVariable)) {
                unknownVariables.push(usedVariable);
            }
        }
        if (unknownVariables.length > 0) {
            if (unknownVariables.length === 1) {
                output.innerHTML = '<p>Votre proposition utilise une variable inconnue: ' + unknownVariables[0] + '</p>';
            }
            else {
                output.innerHTML = '<p>Votre proposition utilise des variables inconnues: ' + unknownVariables.join(', ') + '</p>';
            }
            return;
        }

        ktable.select(expr);
    }

    verifyButton.addEventListener('click', handler);
    exprInput.addEventListener('keyup', function() {
        if (event.key === "Enter") {
            handler();
        }
    });
})();
</script>